!function(t){var e={};function s(a){if(e[a])return e[a].exports;var i=e[a]={i:a,l:!1,exports:{}};return t[a].call(i.exports,i,i.exports,s),i.l=!0,i.exports}s.m=t,s.c=e,s.d=function(t,e,a){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(s.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)s.d(a,i,function(e){return t[e]}.bind(null,i));return a},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s=1)}([function(t,e,s){},function(t,e,s){"use strict";s.r(e);class a{constructor(t){this.cards=[],this._elem=void 0,this._elem=t}push(t){this.cards.push(t),this._elem.append(t.elem)}pop(){return this.cards.pop()}getRect(){return this._elem.getBoundingClientRect()}get count(){return this.cards.length}get top(){return this.cards[this.count-1]}}const i="Blackjack!",r="Push!",n="You won!",o="You lost!",d="ace",h="two",l="three",c="four",u="five",p="six",_="seven",m="eight",y="nine",g="ten",f="jack",b="queen",w="king",k=(new Map).set(d,(t,e)=>t<11&&e<2?11:1).set(h,()=>2).set(l,()=>3).set(c,()=>4).set(u,()=>5).set(p,()=>6).set(_,()=>7).set(m,()=>8).set(y,()=>9).set(g,()=>10).set(f,()=>10).set(b,()=>10).set(w,()=>10),E=[d,h,l,c,u,p,_,m,y,g,f,b,w],v=["clubs","spades","hearts","diamonds"];class C extends a{empty(){this.cards=[]}getTopPosition(t){return{x:(2===this.count?0:this.count-2)*t,y:this.getRect().y}}getValue(){return this.cards.reduce((t,{rank:e},s)=>t+k.get(e)(t,s),0)}isBlackjacked(){return 21===this.getValue()&&2===this.count}isBusted(){return this.getValue()>21}get isCardsLimitReached(){return 5===this.count}}class S extends C{revealSecondCard(){this.cards[1].show()}canDrawCard(){return this.getValue()<17}}const B=t=>new Promise(e=>{const s=t.map(t=>({...t,hasStarted:!1,hasEnded:!1}));requestAnimationFrame((function t(){if(!s.some(({hasEnded:t})=>!t))return e();const a=Date.now();s.forEach(t=>{const{start:e,end:s,onStart:i,onProgress:r,onEnd:n,hasStarted:o,hasEnded:d}=t;var h;d||a<e||(o||(t.hasStarted=!0,null==i||i()),null==r||r((h=(a-e)/(s-e))<.5?4*h**3:(h-1)*(2*h-2)*(2*h-2)+1),a>s&&(t.hasEnded=!0,null==n||n()))}),requestAnimationFrame(t)}))}),x=(t,e,s)=>t+(e-t)*s;class P{constructor(t,e,s){this.elem=document.createElement("div"),this.rank=void 0,this._backClassName="card back",this._faceClassName=void 0,this.rank=t;const a=-s/4;this.setTransform(a,a),this.foreground=s,this._faceClassName=`card ${t}-of-${e}`,this._className=this._backClassName}show(){this._className=this._faceClassName}hide(){this._className=this._backClassName}getTransform(){return(t=>{const[,,,,e,s]=getComputedStyle(t).getPropertyValue("transform").replace(/[^0-9\-.,]/g,"").split(",");return{x:+e||0,y:+s||0}})(this.elem)}setTransform(t,e){this._style.transform=`translate(${t}px, ${e}px)`}getRect(){return this.elem.getBoundingClientRect()}set foreground(t){this._style.zIndex=t}set opacity(t){this._style.opacity=t}get _style(){return this.elem.style}set _className(t){this.elem.className=t}}class T{constructor({delay:t=0,duration:e=0,onStart:s,onProgress:a,onEnd:i}){this.start=void 0,this.end=void 0,this.onStart=void 0,this.onProgress=void 0,this.onEnd=void 0,this.start=t+Date.now(),this.end=this.start+e,this.onStart=s,this.onProgress=a,this.onEnd=i}}class D extends a{constructor(t,e,s){super(t),e.forEach(t=>{s.forEach(e=>{this.push(new P(e,t,this.count))})})}async intro(){this.cards.forEach((t,e)=>{const s=-e/4;t.show(),t.setTransform(s,-200+s),t.opacity=0}),await B(this.cards.map((t,e)=>{const{x:s,y:a}=t.getTransform(),i=-e/4;return new T({delay:8*e,duration:600,onProgress:e=>{t.setTransform(x(s,i,e),x(a,i,e)),t.opacity=x(0,1,e)},onEnd:()=>{t.hide()}})}))}async shuffle(){for(let t=this.count-1;t;t--){const e=Math.random()*(t+1)|0;[this.cards[t],this.cards[e]]=[this.cards[e],this.cards[t]]}await B(this.cards.reduce((t,e,s)=>{const a=2*s,{x:i,y:r}=e.getTransform(),n=(2*Math.round(Math.random())-1)*(Math.random()*e.getRect().width/2+30),o=-s/4;return t.push(new T({delay:a,duration:200,onProgress:t=>{e.setTransform(x(i,n,t),x(r,o,t))}}),new T({duration:200,delay:a+200,onStart:()=>{e.foreground=s},onProgress:t=>{e.setTransform(x(n,o,t),o)}})),t},[]))}toForeground(){this._style.zIndex="1"}toBackground(){this._style.zIndex="-1"}getTopPosition(){const{x:t,y:e}=this.getRect(),{x:s,y:a}=this.top.getTransform();return{x:t+s,y:e+a}}get _style(){return this._elem.style}}class j{constructor(t){this.elem=void 0,this._elem=t}attachHandler(t){this._elem.onclick=t}disable(){this._elem.setAttribute("disabled","")}enable(){this._elem.removeAttribute("disabled")}}class R{constructor(t,e,s,a){this.deal=void 0,this.reset=void 0,this.hit=void 0,this.stand=void 0,this.deal=new j(t),this.reset=new j(e),this.hit=new j(s),this.stand=new j(a)}disableAll(){this.deal.disable(),this.reset.disable(),this.hit.disable(),this.stand.disable()}allowHitOrStand(){this.hit.enable(),this.stand.enable()}}class W{constructor(t){this._elem=void 0,this._elem=t}show(t){this._elem.innerText=t,B([new T({duration:200,onProgress:t=>{this._opacity=x(0,1,t)},onEnd:()=>{this._opacity=""}})])}hide(){this._isVisible&&B([new T({duration:300,onProgress:t=>{this._opacity=x(1,0,t)},onEnd:()=>{this._opacity=0}})])}get _style(){return this._elem.style}set _opacity(t){this._style.opacity=t}get _isVisible(){return"0"!==this._style.opacity}}class I{constructor(t,e,s){this._dealer=void 0,this._deck=void 0,this._player=void 0,this._dealer=t,this._deck=e,this._player=s}async supplyPlayerWithCard(){await this._dragCardFromDeck(this._player)}async supplyDealerWithCard(t){await this._dragCardFromDeck(this._dealer,t)}supplyDeckWithCards(){[...this._player.cards,...this._dealer.cards].forEach(t=>{const{x:e,y:s,width:a,height:i}=t.getRect(),{x:r,y:n}=this._deck.getRect();t.hide(),t.setTransform(e-r+a/2,s-n+i/2),this._deck.push(t)})}async _dragCardFromDeck(t,e=!0){const s=this._deck.pop(),{x:a,y:i}=s.getTransform(),{x:r,y:n}=t.getTopPosition(s.getRect().width),o=n-this._deck.getRect().y;await B([new T({duration:300,onProgress:t=>{s.setTransform(x(a,r,t),x(i,o,t))},onEnd:()=>{s.setTransform(r,0),e&&s.show(),t.push(s)}})])}}s(0);new class{constructor({dealerElem:t,deckElem:e,playerElem:s,popupElem:a,dealBtnElem:i,resetBtnElem:r,hitBtnElem:n,standBtnElem:o}){this._dealer=void 0,this._deck=void 0,this._player=void 0,this._popup=void 0,this._buttons=void 0,this._cardSupplier=void 0,this._dealer=new S(t),this._deck=new D(e,v,E),this._player=new C(s),this._popup=new W(a),this._buttons=new R(i,r,n,o),this._cardSupplier=new I(this._dealer,this._deck,this._player),this._buttons.deal.attachHandler(()=>{this._deal()}),this._buttons.reset.attachHandler(()=>{this._reset()}),this._buttons.hit.attachHandler(()=>{this._hit()}),this._buttons.stand.attachHandler(()=>{this._stand()}),this._deck.intro().then(()=>{this._buttons.deal.enable()})}async _deal(){this._popup.hide(),this._buttons.disableAll(),this._deck.toForeground(),await this._deck.shuffle(),await this._deck.shuffle(),await this._cardSupplier.supplyPlayerWithCard(),await this._cardSupplier.supplyPlayerWithCard(),await this._cardSupplier.supplyDealerWithCard(),await this._cardSupplier.supplyDealerWithCard(!1),this._buttons.reset.enable(),this._checkForBlackjack()}async _reset(){this._popup.hide(),this._buttons.disableAll(),this._deck.toBackground(),this._cardSupplier.supplyDeckWithCards(),this._dealer.empty(),this._player.empty(),await this._deck.shuffle(),await this._deck.shuffle(),this._buttons.deal.enable()}async _hit(){this._buttons.disableAll(),await this._cardSupplier.supplyPlayerWithCard(),this._player.isBusted()?(this._dealer.revealSecondCard(),this._popup.show(o),this._buttons.reset.enable()):this._player.isCardsLimitReached?this._stand():(this._buttons.reset.enable(),this._buttons.allowHitOrStand())}async _stand(){this._buttons.disableAll(),this._dealer.revealSecondCard(),await this._supplyDealerWithCards(),this._conclude()}_checkForBlackjack(){this._player.isBlackjacked()||this._dealer.isBlackjacked()?(this._popup.show(i),this._dealer.revealSecondCard()):this._buttons.allowHitOrStand()}async _supplyDealerWithCards(){this._dealer.canDrawCard()&&!this._dealer.isCardsLimitReached&&(await this._cardSupplier.supplyDealerWithCard(),await this._supplyDealerWithCards())}_conclude(){const t=this._player.getValue(),e=this._dealer.getValue();let s=o;this._dealer.isBusted()||t>e?s=n:t===e&&(s=r),this._popup.show(s),this._buttons.reset.enable()}}({dealerElem:document.getElementById("dealer"),deckElem:document.getElementById("deck"),playerElem:document.getElementById("player"),popupElem:document.getElementById("popup"),dealBtnElem:document.getElementById("deal-btn"),resetBtnElem:document.getElementById("reset-btn"),hitBtnElem:document.getElementById("hit-btn"),standBtnElem:document.getElementById("stand-btn")})}]);