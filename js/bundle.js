!function(t){var e={};function s(a){if(e[a])return e[a].exports;var i=e[a]={i:a,l:!1,exports:{}};return t[a].call(i.exports,i,i.exports,s),i.l=!0,i.exports}s.m=t,s.c=e,s.d=function(t,e,a){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(s.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)s.d(a,i,function(e){return t[e]}.bind(null,i));return a},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s=1)}([function(t,e,s){},function(t,e,s){"use strict";s.r(e);class a{constructor(t){this.cards=[],this._elem=void 0,this._elem=t}push(t){return this.cards.push(t),this._elem.append(t.elem),this}pop(){return this.cards.pop()}getRect(){return this._elem.getBoundingClientRect()}get count(){return this.cards.length}get topCard(){return this.cards[this.count-1]}}const i="Blackjack!",r="Push!",n="You won!",o="You lost!",h="ace",d="two",l="three",c="four",u="five",p="six",_="seven",m="eight",y="nine",f="ten",g="jack",b="queen",w="king",E={[h]:(t,e)=>t<11&&e<2?11:1,[d]:()=>2,[l]:()=>3,[c]:()=>4,[u]:()=>5,[p]:()=>6,[_]:()=>7,[m]:()=>8,[y]:()=>9,[f]:()=>10,[g]:()=>10,[b]:()=>10,[w]:()=>10},k=[h,d,l,c,u,p,_,m,y,f,g,b,w],v=["clubs","spades","hearts","diamonds"],C=t=>new Promise(e=>{const s=t.map(t=>({...t,hasStarted:!1,hasEnded:!1}));requestAnimationFrame((function t(){if(!s.some(({hasEnded:t})=>!t))return e();const a=Date.now();s.forEach(t=>{const{start:e,end:s,onStart:i,onProgress:r,onEnd:n,hasStarted:o,hasEnded:h}=t;var d;h||a<e||(o||(t.hasStarted=!0,null==i||i()),null==r||r((d=(a-e)/(s-e))<.5?4*d**3:(d-1)*(2*d-2)*(2*d-2)+1),a>s&&(t.hasEnded=!0,null==n||n()))}),requestAnimationFrame(t)}))}),B=(t,e,s)=>t+(e-t)*s;class S{constructor({delay:t=0,duration:e=0,onStart:s,onProgress:a,onEnd:i}){this.start=void 0,this.end=void 0,this.onStart=void 0,this.onProgress=void 0,this.onEnd=void 0,this.start=t+Date.now(),this.end=this.start+e,this.onStart=s,this.onProgress=a,this.onEnd=i}}class x extends a{async drag(t){const{x:e,y:s}=this.topCard.getTransform(),a=(3===this.count?0:this.count-3)*this.topCard.getRect().width;await C([new S({duration:400,onProgress:t=>{this.topCard.setTransform(B(e,a,t),B(s,0,t))},onEnd:()=>{t&&this.topCard.show()}})])}empty(){this.cards=[]}getScore(){return this.cards.reduce((t,{rank:e},s)=>t+E[e](t,s),0)}hasBlackjack(){return 21===this.getScore()&&2===this.count}hasBust(){return this.getScore()>21}get hasCardsLimit(){return 5===this.count}}class P extends x{revealSecondCard(){this.cards[1].show()}canDrawCard(){return this.getScore()<17}}class T{constructor(t,e,s){this.elem=document.createElement("div"),this.rank=void 0,this._backClassName="card back",this._faceClassName=void 0,this.rank=t;const a=-s/4;this.setTransform(a,a).foreground=s,this._faceClassName=`card ${t}-of-${e}`,this._className=this._backClassName}show(){return this._className=this._faceClassName,this}hide(){return this._className=this._backClassName,this}getTransform(){return(t=>{const[,,,,e,s]=getComputedStyle(t).transform.replace(/[^\d\-.,]/g,"").split(",");return{x:+e||0,y:+s||0}})(this.elem)}setTransform(t,e){return this._style.transform=`translate(${t}px, ${e}px)`,this}getRect(){return this.elem.getBoundingClientRect()}set foreground(t){this._style.zIndex=t}set opacity(t){this._style.opacity=t}get _style(){return this.elem.style}set _className(t){this.elem.className=t}}class H extends a{constructor(t,e,s){super(t),e.forEach(t=>{s.forEach(e=>{this.push(new T(e,t,this.count))})})}async intro(){this.cards.forEach((t,e)=>{const s=-e/4;t.show().setTransform(s,-200+s).opacity=0}),await C(this.cards.map((t,e)=>{const{x:s,y:a}=t.getTransform(),i=-e/4;return new S({delay:8*e,duration:600,onProgress:e=>{t.setTransform(B(s,i,e),B(a,i,e)).opacity=B(0,1,e)},onEnd:()=>{t.hide()}})}))}async shuffle(){for(let t=this.count-1;t;t--){const e=Math.random()*(t+1)|0;[this.cards[t],this.cards[e]]=[this.cards[e],this.cards[t]]}await C(this.cards.reduce((t,e,s)=>{const a=2*s,{x:i,y:r}=e.getTransform(),n=(2*Math.round(Math.random())-1)*(Math.random()*e.getRect().width/2+30),o=-s/4;return t.push(new S({delay:a,duration:200,onProgress:t=>{e.setTransform(B(i,n,t),B(r,o,t))}}),new S({duration:200,delay:a+200,onStart:()=>{e.foreground=s},onProgress:t=>{e.setTransform(B(n,o,t),o)}})),t},[]))}getTopPosition(){const{x:t,y:e}=this.getRect(),{x:s,y:a}=this.topCard.getTransform();return{x:t+s,y:e+a}}}class j{constructor(t){this.elem=void 0,this._elem=t}attachHandler(t){this._elem.onclick=t}disable(){this._elem.setAttribute("disabled","")}enable(){this._elem.removeAttribute("disabled")}}class W{constructor(t,e,s,a){this.deal=void 0,this.reset=void 0,this.hit=void 0,this.stand=void 0,this.deal=new j(t),this.reset=new j(e),this.hit=new j(s),this.stand=new j(a)}disableAll(){this.deal.disable(),this.reset.disable(),this.hit.disable(),this.stand.disable()}allowHitOrStand(){this.hit.enable(),this.stand.enable()}}class N{constructor(t){this._elem=void 0,this._elem=t}show(t){this._elem.innerText=t,C([new S({duration:100,onProgress:t=>{this._opacity=B(0,1,t)},onEnd:()=>{this._opacity=""}})])}hide(){this._isVisible&&C([new S({duration:200,onProgress:t=>{this._opacity=B(1,0,t)},onEnd:()=>{this._opacity=0}})])}get _style(){return this._elem.style}set _opacity(t){this._style.opacity=t}get _isVisible(){return"0"!==this._style.opacity}}s(0);new class{constructor({dealerElem:t,deckElem:e,playerElem:s,popupElem:a,dealBtnElem:i,resetBtnElem:r,hitBtnElem:n,standBtnElem:o}){this._dealer=void 0,this._deck=void 0,this._player=void 0,this._popup=void 0,this._buttons=void 0,this._dealer=new P(t),this._deck=new H(e,v,k),this._player=new x(s),this._popup=new N(a),this._buttons=new W(i,r,n,o),this._buttons.deal.attachHandler(()=>{this._deal()}),this._buttons.reset.attachHandler(()=>{this._reset()}),this._buttons.hit.attachHandler(()=>{this._hit()}),this._buttons.stand.attachHandler(()=>{this._stand()}),(async()=>{await this._deck.intro(),await this._deck.shuffle(),await this._deck.shuffle(),this._buttons.deal.enable()})()}async _deal(){this._popup.hide(),this._buttons.disableAll(),await this._supplyHandWithCard(this._player),await this._supplyHandWithCard(this._player),await this._supplyHandWithCard(this._dealer),await this._supplyHandWithCard(this._dealer,!1),this._buttons.reset.enable(),this._checkForBlackjack()}async _reset(){this._popup.hide(),this._buttons.disableAll(),this._supplyDeckWithCards(),this._dealer.empty(),this._player.empty(),await this._deck.shuffle(),await this._deck.shuffle(),this._buttons.deal.enable()}async _hit(){this._buttons.disableAll(),await this._supplyHandWithCard(this._player),this._player.hasBust()?(this._dealer.revealSecondCard(),this._popup.show(o),this._buttons.reset.enable()):this._player.hasCardsLimit?this._stand():(this._buttons.reset.enable(),this._buttons.allowHitOrStand())}async _stand(){this._buttons.disableAll(),this._dealer.revealSecondCard(),await this._supplyDealerWithCards(),this._conclude()}async _supplyHandWithCard(t,e=!0){const{x:s,y:a}=this._deck.getTopPosition(),{x:i,y:r}=t.getRect();await t.push(this._deck.pop().setTransform(s-i,a-r)).drag(e)}_checkForBlackjack(){this._player.hasBlackjack()||this._dealer.hasBlackjack()?(this._popup.show(i),this._dealer.revealSecondCard()):this._buttons.allowHitOrStand()}_supplyDeckWithCards(){[...this._player.cards,...this._dealer.cards].forEach(t=>{const{x:e,y:s,width:a,height:i}=t.getRect(),{x:r,y:n}=this._deck.getRect();this._deck.push(t.hide().setTransform(e-r+a/2,s-n+i/2))})}async _supplyDealerWithCards(){this._dealer.canDrawCard()&&!this._dealer.hasCardsLimit&&(await this._supplyHandWithCard(this._dealer),await this._supplyDealerWithCards())}_conclude(){const t=this._player.getScore(),e=this._dealer.getScore();let s=o;this._dealer.hasBust()||t>e?s=n:t===e&&(s=r),this._popup.show(s),this._buttons.reset.enable()}}({dealerElem:document.getElementById("dealer"),deckElem:document.getElementById("deck"),playerElem:document.getElementById("player"),popupElem:document.getElementById("popup"),dealBtnElem:document.getElementById("deal-btn"),resetBtnElem:document.getElementById("reset-btn"),hitBtnElem:document.getElementById("hit-btn"),standBtnElem:document.getElementById("stand-btn")})}]);